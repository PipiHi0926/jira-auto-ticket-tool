# 🎉 JIRA 自動開單工具 - 更新說明

## ✨ 新功能 (v2.0)

### 1. 📁 多 Project 支援

現在支援多個 JIRA Project (Center),每個 Project 都有獨立的設定:

- **MCC (Major Change Center)** - 主要變更中心
  - Issue Type: Change
  - 自訂欄位: 變更類型、影響等級、影響系統

- **TC (Task Center)** - 任務中心
  - Issue Type: Task
  - 自訂欄位: 任務類別、預估工時

- **AC (AR Center)** - AR 中心
  - Issue Type: Request
  - 自訂欄位: 請求類型

### 2. 🎨 自訂欄位支援

每個 Project 可以定義自己的自訂欄位:
- 支援類型: 文字、下拉選單、數字
- 可設定必填/選填
- 模板可以預設自訂欄位的值

### 3. 📋 改進的模板系統

- **Project 綁定**: 每個模板屬於特定的 Project
- **自動分類**: 模板按 Project 分組顯示
- **智慧過濾**: 選擇 Project 後只顯示相關模板

### 4. 🎯 預設模板

已為你建立 6 個實用模板:

**MCC Project:**
1. 參數調整模板 - 用於系統參數調整
2. 系統升級模板 - 用於版本升級
3. 配置變更模板 - 用於配置修改

**TC Project:**
4. 開發任務模板 - 用於開發工作
5. 維護任務模板 - 用於系統維護

**AC Project:**
6. 新增請求模板 - 用於資源請求

## 📖 使用流程

### 建立 Issue 的新流程:

1. **選擇 Project** 
   - 點擊你要開單的 Project (MCC/TC/AC)
   - 系統會自動設定該 Project 的 Issue Type

2. **選擇模板**
   - 只會顯示該 Project 的模板
   - 點擊模板自動填入預設值

3. **填寫/調整內容**
   - 基本欄位: 標題、描述、優先級等
   - 自訂欄位: 根據 Project 自動顯示

4. **建立 Issue**
   - 點擊「建立 Issue」按鈕
   - 自訂欄位會附加在描述中

## 🔧 設定說明

### config.json 結構

```json
{
  "jira_url": "你的 JIRA URL",
  "username": "使用者名稱",
  "password": "密碼",
  "projects": [
    {
      "key": "MCC",
      "name": "Major Change Center",
      "description": "主要變更中心",
      "default_issuetype": "Change",
      "custom_fields": {
        "change_type": {
          "label": "變更類型",
          "type": "select",
          "options": ["參數調整", "系統升級", "配置變更", "其他"],
          "required": false
        }
      }
    }
  ],
  "default_project": "MCC"
}
```

### 新增 Project

在 `config.json` 的 `projects` 陣列中新增:

```json
{
  "key": "YOUR_PROJECT_KEY",
  "name": "Project 名稱",
  "description": "Project 描述",
  "default_issuetype": "預設的 Issue Type",
  "custom_fields": {
    "field_key": {
      "label": "欄位顯示名稱",
      "type": "select|text|number",
      "options": ["選項1", "選項2"],  // 只有 select 需要
      "required": true|false
    }
  }
}
```

### 新增模板

在「模板管理」頁面:
1. 點擊「新增模板」
2. 選擇所屬 Project
3. 填寫模板資訊
4. 儲存

或直接編輯 `ticket_templates/templates.json`:

```json
{
  "id": "template_x",
  "project_key": "MCC",
  "name": "模板名稱",
  "description": "模板描述",
  "fields": {
    "summary": "預設標題",
    "description": "預設描述",
    "issuetype": "Change",
    "priority": "Medium",
    "custom_fields": {
      "change_type": "參數調整",
      "impact_level": "中"
    }
  }
}
```

## 💡 使用技巧

1. **快速切換 Project**: 在建立 Issue 頁面可以隨時切換 Project

2. **模板預設值**: 善用模板的自訂欄位預設值,減少重複填寫

3. **自訂欄位映射**: 目前自訂欄位會附加在描述中,如需直接映射到 JIRA 自訂欄位,需要在 `app.py` 中配置欄位 ID

4. **批次開單**: 選好模板後,只需調整少量內容即可快速開單

## 🔄 從 v1.0 升級

如果你已經有舊版本:

1. **備份資料**:
   ```bash
   copy config.json config.json.backup
   copy ticket_templates\templates.json ticket_templates\templates.json.backup
   ```

2. **更新檔案**:
   - 用新的 `config.json` 結構替換
   - 用新的 `templates.json` 替換
   - 或手動遷移你的自訂設定

3. **重新啟動**:
   ```bash
   python app.py
   ```

## 🐛 已知限制

1. **自訂欄位映射**: 目前自訂欄位會附加在描述中,而非直接寫入 JIRA 自訂欄位
   - 原因: 每個公司的 JIRA 自訂欄位 ID 不同
   - 解決: 可以在 `app.py` 的 `create_issue` 函數中手動配置映射

2. **Issue Type 固定**: 每個 Project 只能有一個預設 Issue Type
   - 如需多種 Issue Type,建議建立多個 Project

## 📝 未來規劃

- [ ] 支援 JIRA 自訂欄位 ID 自動映射
- [ ] 批次建立 Issues
- [ ] Issue 歷史記錄
- [ ] 模板匯入/匯出
- [ ] 支援附件上傳

## 🤝 需要幫助?

如有問題或建議,歡迎隨時提出!

---

**版本**: v2.0  
**更新日期**: 2025-12-16  
**適用於**: TSMC 內部使用
